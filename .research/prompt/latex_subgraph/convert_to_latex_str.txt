
LLM Name: gpt-5-2025-08-07
Input:

You are a LaTeX expert.
Your task is to convert each section of a research paper into plain LaTeX **content only**, without including any section titles or metadata.

Below are the paper sections. For each one, convert only the **content** into LaTeX:

---
Section: title

Confidence-Weighted Entropy Minimization for One-Step Test-Time Adaptation

---

---
Section: abstract

Test-time adaptation (TTA) updates a model on the incoming data stream to counteract distribution shift without requiring labels. Entropy-minimization methods such as TENT restrict adaptation to the affine parameters of Batch Normalization and achieve good accuracy, yet they typically run three to ten gradient steps per mini-batch, inflating latency. We revisit the core obstacle—noisy gradients dominated by high-entropy samples early in adaptation—and propose Confidence-Weighted TENT (CW-TENT). CW-TENT rescales each sample’s entropy by the confidence weight w = 1 – H(p)/log C and minimizes the normalized weighted loss with a single stochastic-gradient step per batch, aiming to preserve accuracy while cutting computation. We implement CW-TENT for a pre-trained ResNet-18 and evaluate it on CIFAR-10-C at corruption severity 5 against the 10-step TENT baseline. Contrary to expectation, the logged run shows severe degradation: CW-TENT reaches only 10.11 percent final top-1 accuracy versus 37.41 percent for TENT, although it reduces back-propagation steps by a factor of ten. Learning-curve analysis attributes the collapse to weight saturation, unstable Batch-Norm statistics, and an oversized learning rate. We dissect these failure modes and outline concrete stabilisation strategies—temperature-scaled weights, adaptive step sizes, and hybrid updates—thereby providing a data-backed cautionary tale for confidence-aware objectives in fast TTA.

---

---
Section: introduction

Deep neural networks often encounter distribution shift once deployed, suffering dramatic performance losses. Test-time adaptation (TTA) addresses this problem by updating a subset of parameters online using the unlabeled test stream. Among the many variants, entropy minimisation with Batch-Norm (BN)–only updates, popularised by TENT, stands out for its simplicity: it keeps most weights frozen, relies solely on the model’s own predictions, and delivers substantial gains under common corruptions. Despite these advantages, TENT typically needs multiple inner gradient steps per mini-batch to stabilise noisy gradients, which increases inference latency—a critical drawback for real-time applications.  This work explores whether a minimal change to the loss can eliminate the inner-loop while retaining accuracy. The central intuition is straightforward: high-confidence predictions are more reliable indicators of the target distribution than low-confidence ones. If their gradients are emphasised, fewer optimisation steps may suffice. We therefore introduce Confidence-Weighted TENT (CW-TENT), which multiplies each sample’s entropy by the confidence weight w = 1 – H(p)/log C and minimises the average weighted entropy using a single stochastic-gradient step per batch.  The idea appears promising. It preserves the BN-only parameter footprint, requires just four extra lines of code, and, in principle, reduces per-batch computation by an order of magnitude. To test the hypothesis we conduct a controlled study on CIFAR-10-C at corruption severity 5 with a pre-trained ResNet-18. We compare CW-TENT to the standard 10-step TENT baseline and analyse online accuracy, convergence speed, and computational cost. Contrary to our initial expectation, CW-TENT collapses within the first few batches, finishing at 10.11 percent top-1 accuracy—27.3 percentage points below TENT. Diagnostics reveal that aggressive down-weighting of high-entropy samples shrinks the effective batch size, destabilises BN statistics, and interacts unfavourably with the learning rate inherited from multi-step TENT.  These negative results are nonetheless instructive. They delineate the boundary conditions under which confidence weighting harms rather than helps, highlight the delicate interplay between loss shaping and normalisation, and resonate with recent reports that stabilising BN statistics is crucial for fully test-time adaptation \cite{zhao-2023-delta}. Similar lessons emerge in other vision domains, where regularised losses at test time must be carefully balanced to prevent degenerate minima \cite{author-year-test}.  Contributions • We propose confidence-weighted entropy minimisation as a drop-in modification to BN-only TTA aimed at enabling one-step updates. • We provide the first empirical evaluation of this idea on CIFAR-10-C, contrasting CW-TENT with a strong multi-step TENT baseline. • We present a thorough negative result, diagnosing failure modes tied to weight saturation, learning-rate overshoot, and unreliable BN statistics. • We outline concrete stabilisation tactics—temperature scaling, adaptive step sizes, and hybrid updates—that future work can test.  By exposing the pitfalls of confidence weighting in the single-step regime, our study refines the design space for fast TTA and underscores the need to couple objective modifications with robust normalisation and optimisation control.

---

---
Section: related_work

Entropy-based TTA. The original TENT framework adapts BN affine parameters by minimising prediction entropy, achieving strong gains across synthetic corruptions but incurring multiple inner-loop steps. Several works refine this recipe through additional regularisers or second-order updates. Our work differs by retaining the core entropy objective yet re-weighting it to prioritise confident samples in a single step.  Normalisation-centric approaches. DELTA augments TENT with Test-time Batch Renormalisation and Dynamic Online re-weighting to mitigate inaccurate BN statistics and class-bias in the updates \cite{zhao-2023-delta}. Whereas DELTA changes the normaliser and adds class-level weighting, CW-TENT leaves normalisation untouched and operates at the sample level. The two strategies are therefore complementary; however, our logs do not include DELTA, so direct comparison is left for future work.  Loss regularisation in related tasks. In weakly supervised salient object detection, tailored test-time regularisers have been shown to boost performance while maintaining stability \cite{author-year-test}. These studies emphasise the risk of objective functions that over-amplify certain signals, a concern manifested in our collapse under aggressive confidence weighting.  In summary, prior work typically improves TTA by enhancing BN statistics or adding balanced regularisers. Our attempt to accelerate convergence via confidence-based loss shaping unmasks new stability challenges, highlighting the importance of joint design across loss, optimiser, and normalisation.

---

---
Section: background

Problem setting. Let f_θ denote a classifier trained on a source distribution and deployed on a target stream with unknown shift. Labels are unavailable at test time. The model processes each mini-batch sequentially and may update a designated subset of parameters before predicting the next batch.  Standard TENT. TENT keeps only the BN affine parameters (γ, β) trainable. For a batch B of size N with class-probability vectors p_i, TENT minimises the unweighted entropy loss L = Σ_i H(p_i), where H(p) = −Σ_c p_c log p_c. It performs K inner SGD steps (typically 3–10) and relies on current-batch statistics for BN.  Confidence-weighted modification. We hypothesise that noisy gradients arising from high-entropy samples hamper one-step convergence. Defining the confidence weight w_i = 1 – H(p_i)/log C in the range , we construct the weighted loss L_w = (Σ_i w_i H(p_i)) / (Σ_i w_i). When many samples are high-entropy, most weights shrink toward zero, potentially reducing gradient noise but also the effective batch size used by BN. This trade-off lies at the heart of our empirical investigation.  Challenges. (1) BN statistics depend on the full batch; if weighting effectively discards many samples, mean and variance estimates become unreliable. (2) A learning rate chosen for multi-step optimisation may overshoot in the single-step setting. (3) Weight saturation may nullify stabilising gradients early in adaptation, permitting a single unreliable update to derail the model. Addressing these issues requires mechanisms beyond loss shaping, as will be revisited in Section Results.

---

---
Section: method

CW-TENT retains the TENT optimisation pipeline with two minimal changes: a confidence-weighted loss and a single inner step. For each incoming batch: 1 Set the model to training mode so BN uses batch statistics. 2 Compute logits, probabilities p_i, entropies H_i, and weights w_i = 1 – H_i/log C. 3 Form the loss L_w = (Σ_i w_i H_i)/(Σ_i w_i). 4 Back-propagate L_w and update γ, β with one SGD step (learning rate 1 × 10⁻³, momentum 0.9). 5 Return the model to evaluation mode.  Implementation consists of enabling gradients on BN affine parameters and adding four lines to compute w and the weighted loss. Theoretical intuition predicts that emphasising low-entropy samples improves the signal-to-noise ratio of the gradient, permitting large steps or fewer iterations. Yet the same weighting reduces the sample count contributing to BN, potentially destabilising mean–variance estimates. Our experiments evaluate which effect dominates in practice.

---

---
Section: experimental_setup

Dataset and model. We follow the canonical TTA benchmark of CIFAR-10-C at corruption severity 5. The evaluation stream contains 10 000 images delivered sequentially. The backbone is a pre-trained ResNet-18 (11.7 million parameters).  Adapters. (i) Vanilla TENT: unweighted entropy, 10 SGD steps per batch. (ii) CW-TENT: confidence-weighted entropy, 1 SGD step per batch. Both adapters modify only BN affine parameters and employ SGD with learning rate 1 × 10⁻³, momentum 0.9.  Metrics. Primary: online top-1 accuracy on each batch and after the full stream (higher is better). Secondary: per-batch latency measured on a single NVIDIA A100, and qualitative diagnostics from learning curves and batch-level accuracy histograms.  Hardware and execution. All runs execute on one A100; latency is recorded with torch.cuda.Event timers.  Logged runs. The analysis draws on two complete logs: • proposed-ResNet-18-11-7M--CIFAR-10-C-severity-5 (CW-TENT, final accuracy 0.1011). • comparative-1-ResNet-18-11-7M--CIFAR-10-C-severity-5 (TENT, final accuracy 0.3741). The source-only adapter was planned but not executed, so it is omitted from the quantitative tables.

---

---
Section: results

Overall accuracy. After processing the full 10 000-image stream, CW-TENT attains 10.11 percent top-1 accuracy, whereas vanilla TENT reaches 37.41 percent. The gap of 27.3 points indicates a substantial failure of the confidence-weighted objective to maintain accuracy.  Convergence behaviour. Figure 2 shows that CW-TENT begins near the source checkpoint’s accuracy but collapses within ten batches, stabilising at chance-level performance. Vanilla TENT, while noisy, improves steadily over the stream. Batch-level accuracy histograms in Figure 3 reveal a bimodal distribution for CW-TENT, dominated by a low-accuracy mode, confirming widespread misclassification.  Computational cost. One gradient step per batch yields a 10× reduction in back-propagation and cuts per-batch latency from 7.1 ms (TENT) to 0.8 ms (CW-TENT). However, the accuracy deficit outweighs this benefit for most applications.  Failure analysis. Three interacting factors emerge: 1 Normalisation instability: down-weighting discards many samples, so BN statistics are estimated from a handful of confident examples, leading to unreliable γ, β updates. 2 Learning-rate overshoot: the step size suitable for 10-step optimisation proves too large for a single step on a sharper loss surface. 3 Weight saturation: for CIFAR-10, entropy above 1.84 assigns w < 0.2, eliminating stabilising gradients from the majority of early-stream samples.  Suggested mitigations include scaling the learning rate by the batch-mean weight, introducing a temperature τ > 1 in the weight definition, appending a tiny unweighted micro-step, and clipping large BN updates; none are tested in the present logs.  Fairness considerations. Both runs share architecture, data stream, optimiser, and evaluation code; only the loss definition and number of inner steps differ.  Figures.  Figure 1: Final accuracy comparison between CW-TENT and TENT; higher is better (filename: final_accuracy_comparison.pdf).  Figure 2: Online accuracy over the 10 000-sample stream; higher is better (filename: learning_curve.pdf).  Figure 3: Batch-level accuracy distribution for both adapters; higher is better (filename: batch_acc_distribution.pdf).  Figure 4: Confusion matrices of the evaluated models; higher diagonal values are better (filename: confusion_matrix.pdf).  Figure 5: Aggregated metrics file used to generate summary plots (filename: aggregated_metrics.json).  Figure 6: Per-run metrics JSON with detailed logs (filename: metrics.json).  Figure 7: Statistical significance tests comparing adapters (filename: significance_tests.json).

---

---
Section: conclusion

We introduced confidence-weighted entropy minimisation to accelerate BN-only test-time adaptation by collapsing the inner loop to a single gradient step. An empirical study on CIFAR-10-C reveals that, in its naïve form, the method dramatically underperforms the multi-step TENT baseline, achieving 10.11 percent versus 37.41 percent final accuracy. Detailed diagnostics attribute the collapse to unstable Batch-Norm statistics, learning-rate overshoot, and excessive weight saturation. Although CW-TENT delivers a ten-fold reduction in computation, its accuracy deficit currently precludes practical deployment.  Our findings contribute a carefully documented negative result that sharpens understanding of loss shaping in TTA. They stress that objective modifications must be co-designed with normalisation and optimisation mechanisms, echoing lessons from DELTA’s focus on robust statistics \cite{zhao-2023-delta} and from regularised test-time training in related tasks \cite{author-year-test}. Future work should implement temperature-scaled weights, adaptive learning rates proportional to the batch-mean weight, hybrid weighted-plus-unweighted updates, and improved normalisers to recover stability while retaining single-step efficiency.

---


## LaTeX Formatting Rules:
- Use \subsection{...} for any subsections within this section.
    - Subsection titles should be distinct from the section name;
    - Do not use '\subsection{  }', or other slight variations. Use more descriptive and unique titles.
    - Avoid excessive subdivision. If a subsection is brief or overlaps significantly with another, consider merging them for clarity and flow.

- For listing contributions, use the LaTeX \begin{itemize}...\end{itemize} format.
    - Each item should start with a short title in \textbf{...} format.
    - Avoid using -, *, or other Markdown bullet styles.

- When including tables, use the `tabularx` environment with `\textwidth` as the target width.
    - At least one column must use the `X` type to enable automatic width adjustment and line breaking.
    - Include `\hline` at the top, after the header, and at the bottom. Avoid vertical lines unless necessary.
    - To left-align content in `X` columns, define `
ewcolumntype{Y}{>{
aggedrightrraybackslash}X}` using the `array` package.

- When writing pseudocode, use the `algorithm` and `algorithmicx` LaTeX environments.
    - Only include pseudocode in the `Method` section. Pseudocode is not allowed in any other sections.
    - Prefer the `\begin{algorithmic}` environment using **lowercase commands** such as `\State`, `\For`, and `\If`, to ensure compatibility and clean formatting.
    - Pseudocode must represent actual algorithms or procedures with clear logic. Do not use pseudocode to simply rephrase narrative descriptions or repeat what has already been explained in text.
        - Good Example:
        ```latex
        \State Compute transformed tokens: \(	ilde{T} \leftarrow W\,T\)
        \State Update: \(T_{new} \leftarrow 	ilde{T} + \mu\,T_{prev}\)
        ```
- Figures and images are ONLY allowed in the "Results" section.
    - Use LaTeX float option `[H]` to force placement.

- All figures must be inserted using the following LaTeX format, using a `width` that reflects the filename:
    ```latex
    \includegraphics[width=\linewidth]{ images/filename.pdf }
    ```
    The `<appropriate-width>` must be selected based on the filename suffix:
    - If the filename ends with _pair1.pdf or _pair2.pdf, use 0.48\linewidth as the width of each subfigure environment and place the figures side by side using `subcaption` package.
    - Otherwise (default), use 0.7\linewidth

- **Escaping special characters**:
    - LaTeX special characters (`#`, `$`, `%`, `&`, `~`, `_`, `^`, `{`, `}`, `\`) must be escaped with a leading backslash when they appear in plain text (e.g., `data\_set`, `C\&C`).
    - Underscores **must always be escaped** (`\_`) outside math mode, even in filenames (e.g., memory\_profiler), code-style words, itemize lists, or citation contexts.

- Always use ASCII hyphens (`-`) instead of en-dashes (`–`) or em-dashes (`—`) to avoid spacing issues in hyphenated terms.
- Do not include any of these higher-level commands such as \documentclass{...}, \begin{document}, and \end{document}.
    - Additionally, avoid including section-specific commands such as \begin{abstract}, \section{  }, or any other similar environment definitions.
- Do not modify citation placeholders:
    - Citation placeholders appear in the format [citation_key], where citation_key contains underscores, numbers, and text (e.g., [vaswani_2017_attention], [smith_2023_deep]).
    - You must preserve these placeholders EXACTLY as they appear in the input text.
- If no LaTeX conversion is needed, output the content as-is without status messages like [Unchanged].
Output:
{
    "title": "Confidence-Weighted Entropy Minimization for One-Step Test-Time Adaptation",
    "abstract": "Test-time adaptation (TTA) updates a model on the incoming data stream to counteract distribution shift without requiring labels. Entropy-minimization methods such as TENT restrict adaptation to the affine parameters of Batch Normalization and achieve good accuracy, yet they typically run three to ten gradient steps per mini-batch, inflating latency. We revisit the core obstacle—noisy gradients dominated by high-entropy samples early in adaptation—and propose Confidence-Weighted TENT (CW-TENT). CW-TENT rescales each sample’s entropy by the confidence weight \\(w = 1 - H(p)/\\log C\\) and minimizes the normalized weighted loss with a single stochastic-gradient step per batch, aiming to preserve accuracy while cutting computation. We implement CW-TENT for a pre-trained ResNet-18 and evaluate it on CIFAR-10-C at corruption severity 5 against the 10-step TENT baseline. Contrary to expectation, the logged run shows severe degradation: CW-TENT reaches only 10.11 percent final top-1 accuracy versus 37.41 percent for TENT, although it reduces back-propagation steps by a factor of ten. Learning-curve analysis attributes the collapse to weight saturation, unstable Batch-Norm statistics, and an oversized learning rate. We dissect these failure modes and outline concrete stabilisation strategies—temperature-scaled weights, adaptive step sizes, and hybrid updates—thereby providing a data-backed cautionary tale for confidence-aware objectives in fast TTA.",
    "introduction": "Deep neural networks often encounter distribution shift once deployed, suffering dramatic performance losses. Test-time adaptation (TTA) addresses this problem by updating a subset of parameters online using the unlabeled test stream. Among the many variants, entropy minimisation with Batch-Norm (BN)-only updates, popularised by TENT, stands out for its simplicity: it keeps most weights frozen, relies solely on the model’s own predictions, and delivers substantial gains under common corruptions. Despite these advantages, TENT typically needs multiple inner gradient steps per mini-batch to stabilise noisy gradients, which increases inference latency\n\nThis work explores whether a minimal change to the loss can eliminate the inner-loop while retaining accuracy. The central intuition is straightforward: high-confidence predictions are more reliable indicators of the target distribution than low-confidence ones. If their gradients are emphasised, fewer optimisation steps may suffice. We therefore introduce Confidence-Weighted TENT (CW-TENT), which multiplies each sample’s entropy by the confidence weight \\(w = 1 - H(p)/\\log C\\) and minimises the average weighted entropy using a single stochastic-gradient step per batch.\n\nThe idea appears promising. It preserves the BN-only parameter footprint, requires just four extra lines of code, and, in principle, reduces per-batch computation by an order of magnitude. To test the hypothesis we conduct a controlled study on CIFAR-10-C at corruption severity 5 with a pre-trained ResNet-18. We compare CW-TENT to the standard 10-step TENT baseline and analyse online accuracy, convergence speed, and computational cost. Contrary to our initial expectation, CW-TENT collapses within the first few batches, finishing at 10.11 percent top-1 accuracy—27.3 percentage points below TENT. Diagnostics reveal that aggressive down-weighting of high-entropy samples shrinks the effective batch size, destabilises BN statistics, and interacts unfavourably with the learning rate inherited from multi-step TENT.\n\nThese negative results are nonetheless instructive. They delineate the boundary conditions under which confidence weighting harms rather than helps, highlight the delicate interplay between loss shaping and normalisation, and resonate with recent reports that stabilising BN statistics is crucial for fully test-time adaptation \\cite{zhao-2023-delta}. Similar lessons emerge in other vision domains, where regularised losses at test time must be carefully balanced to prevent degenerate minima \\cite{author-year-test}.\n\n\\subsection{Contributions}\n\\begin{itemize}\n\\item \\textbf{Confidence-weighted entropy minimisation:} A drop-in modification to BN-only TTA aimed at enabling one-step updates.\n\\item \\textbf{Empirical evaluation on CIFAR-10-C:} A controlled comparison of CW-TENT against a strong multi-step TENT baseline.\n\\item \\textbf{Negative result and diagnostics:} A thorough analysis of failure modes tied to weight saturation, learning-rate overshoot, and unreliable BN statistics.\n\\item \\textbf{Stabilisation tactics:} Practical strategies—temperature scaling, adaptive step sizes, and hybrid updates—for improving stability in fast TTA.\n\\end{itemize}\n\nBy exposing the pitfalls of confidence weighting in the single-step regime, our study refines the design space for fast TTA and underscores the need to couple objective modifications with robust normalisation and optimisation control.",
    "related_work": "\\subsection{Entropy-based TTA}\nThe original TENT framework adapts BN affine parameters by minimising prediction entropy, achieving strong gains across synthetic corruptions but incurring multiple inner-loop steps. Several works refine this recipe through additional regularisers or second-order updates. Our work differs by retaining the core entropy objective yet re-weighting it to prioritise confident samples in a single step.\n\n\\subsection{Normalisation-centric approaches}\nDELTA augments TENT with Test-time Batch Renormalisation and Dynamic Online re-weighting to mitigate inaccurate BN statistics and class-bias in the updates \\cite{zhao-2023-delta}. Whereas DELTA changes the normaliser and adds class-level weighting, CW-TENT leaves normalisation untouched and operates at the sample level. The two strategies are therefore complementary; however, our logs do not include DELTA, so direct comparison is left for future work.\n\n\\subsection{Loss regularisation in related tasks}\nIn weakly supervised salient object detection, tailored test-time regularisers have been shown to boost performance while maintaining stability \\cite{author-year-test}. These studies emphasise the risk of objective functions that over-amplify certain signals, a concern manifested in our collapse under aggressive confidence weighting.\n\nIn summary, prior work typically improves TTA by enhancing BN statistics or adding balanced regularisers. Our attempt to accelerate convergence via confidence-based loss shaping unmasks new stability challenges, highlighting the importance of joint design across loss, optimiser, and normalisation.",
    "background": "\\subsection{Problem setting}\nLet \\(f_{\\theta}\\) denote a classifier trained on a source distribution and deployed on a target stream with unknown shift. Labels are unavailable at test time. The model processes each mini-batch sequentially and may update a designated subset of parameters before predicting the next batch.\n\n\\subsection{Standard TENT}\nTENT keeps only the BN affine parameters \\((\\gamma, \\beta)\\) trainable. For a batch \\(B\\) of size \\(N\\) with class-probability vectors \\(p_{i}\\), TENT minimises the unweighted entropy loss \\(L = \\sum_{i} H(p_{i})\\), where \\(H(p) = -\\sum_{c} p_{c} \\log p_{c}\\). It performs \\(K\\) inner SGD steps (typically 3-10) and relies on current-batch statistics for BN.\n\n\\subsection{Confidence-weighted modification}\nWe hypothesise that noisy gradients arising from high-entropy samples hamper one-step convergence. Defining the confidence weight \\(w_{i} = 1 - H(p_{i})/\\log C\\) in the range , we construct the weighted loss \\(L_{w} = \\big(\\sum_{i} w_{i} H(p_{i})\\big) / \\big(\\sum_{i} w_{i}\\big)\\). When many samples are high-entropy, most weights shrink toward zero, potentially reducing gradient noise but also the effective batch size used by BN. This trade-off lies at the heart of our empirical investigation.\n\n\\subsection{Challenges}\n(1) BN statistics depend on the full batch; if weighting effectively discards many samples, mean and variance estimates become unreliable. (2) A learning rate chosen for multi-step optimisation may overshoot in the single-step setting. (3) Weight saturation may nullify stabilising gradients early in adaptation, permitting a single unreliable update to derail the model. Addressing these issues requires mechanisms beyond loss shaping, as will be revisited in Section Results.",
    "method": "CW-TENT retains the TENT optimisation pipeline with two minimal changes: a confidence-weighted loss and a single inner step. For each incoming batch: set the model to training mode so BN uses batch statistics; compute logits, probabilities \\(p_{i}\\), entropies \\(H_{i}\\), and weights \\(w_{i} = 1 - H_{i}/\\log C\\); form the loss \\(L_{w} = (\\sum_{i} w_{i} H_{i})/(\\sum_{i} w_{i})\\); back-propagate \\(L_{w}\\) and update \\(\\gamma, \\beta\\) with one SGD step (learning rate \\(1 \\times 10^{-3}\\), momentum 0.9); return the model to evaluation mode.\n\nImplementation consists of enabling gradients on BN affine parameters and adding four lines to compute \\(w\\) and the weighted loss. Theoretical intuition predicts that emphasising low-entropy samples improves the signal-to-noise ratio of the gradient, permitting large steps or fewer iterations. Yet the same weighting reduces the sample count contributing to BN, potentially destabilising mean-variance estimates. Our experiments evaluate which effect dominates in practice.\n\n\\begin{algorithm}[H]\n\\caption{Confidence-Weighted TENT: per-batch adaptation}\n\\begin{algorithmic}\n\\State \\textbf{Input:} incoming batch \\(B=\\{x_{i}\\}_{i=1}^{N}\\), number of classes \\(C\\); pre-trained network with BN affine params \\((\\gamma, \\beta)\\)\n\\State set model to \\texttt{train} mode \\Comment BN uses batch statistics\n\\State compute logits \\(z_{i} = f_{\\theta}(x_{i})\\); probabilities \\(p_{i} = \\mathrm{softmax}(z_{i})\\)\n\\State compute entropies \\(H_{i} = -\\sum_{c=1}^{C} p_{i,c} \\log p_{i,c}\\)\n\\State compute weights \\(w_{i} = 1 - H_{i}/\\log C\\)\n\\State compute weighted loss \\(L_{w} = \\dfrac{\\sum_{i=1}^{N} w_{i} H_{i}}{\\sum_{i=1}^{N} w_{i}}\\)\n\\State take one SGD step on \\((\\gamma, \\beta)\\) with lr \\(1\\times 10^{-3}\\), momentum 0.9, using gradient of \\(L_{w}\\)\n\\State set model to \\texttt{eval} mode \\Comment for downstream evaluation\n\\end{algorithmic}\n\\end{algorithm}",
    "experimental_setup": "\\subsection{Dataset and model}\nWe follow the canonical TTA benchmark of CIFAR-10-C at corruption severity 5. The evaluation stream contains 10 000 images delivered sequentially. The backbone is a pre-trained ResNet-18 (11.7 million parameters).\n\n\\subsection{Adapters}\n(i) Vanilla TENT: unweighted entropy, 10 SGD steps per batch. (ii) CW-TENT: confidence-weighted entropy, 1 SGD step per batch. Both adapters modify only BN affine parameters and employ SGD with learning rate \\(1 \\times 10^{-3}\\), momentum 0.9.\n\n\\subsection{Metrics}\nPrimary: online top-1 accuracy on each batch and after the full stream (higher is better). Secondary: per-batch latency measured on a single NVIDIA A100, and qualitative diagnostics from learning curves and batch-level accuracy histograms.\n\n\\subsection{Hardware and execution}\nAll runs execute on one A100; latency is recorded with \\texttt{torch.cuda.Event} timers.\n\n\\subsection{Logged runs}\nThe analysis draws on two complete logs: proposed-ResNet-18-11-7M--CIFAR-10-C-severity-5 (CW-TENT, final accuracy 0.1011) and comparative-1-ResNet-18-11-7M--CIFAR-10-C-severity-5 (TENT, final accuracy 0.3741). The source-only adapter was planned but not executed, so it is omitted from the quantitative tables.",
    "results": "\\subsection{Overall accuracy}\nAfter processing the full 10 000-image stream, CW-TENT attains 10.11 percent top-1 accuracy, whereas vanilla TENT reaches 37.41 percent. The gap of 27.3 points indicates a substantial failure of the confidence-weighted objective to maintain accuracy.\n\n\\subsection{Convergence behaviour}\nFigure 2 shows that CW-TENT begins near the source checkpoint’s accuracy but collapses within ten batches, stabilising at chance-level performance. Vanilla TENT, while noisy, improves steadily over the stream. Batch-level accuracy histograms in Figure 3 reveal a bimodal distribution for CW-TENT, dominated by a low-accuracy mode, confirming widespread misclassification.\n\n\\subsection{Computational cost}\nOne gradient step per batch yields a \\(10\\times\\) reduction in back-propagation and cuts per-batch latency from 7.1 ms (TENT) to 0.8 ms (CW-TENT). However, the accuracy deficit outweighs this benefit for most applications.\n\n\\subsection{Failure analysis}\nThree interacting factors emerge: (1) Normalisation instability: down-weighting discards many samples, so BN statistics are estimated from a handful of confident examples, leading to unreliable \\(\\gamma, \\beta\\) updates. (2) Learning-rate overshoot: the step size suitable for 10-step optimisation proves too large for a single step on a sharper loss surface. (3) Weight saturation: for CIFAR-10, entropy above 1.84 assigns \\(w < 0.2\\), eliminating stabilising gradients from the majority of early-stream samples. Suggested mitigations include scaling the learning rate by the batch-mean weight, introducing a temperature \\(\\tau > 1\\) in the weight definition, appending a tiny unweighted micro-step, and clipping large BN updates; none are tested in the present logs.\n\n\\subsection{Fairness considerations}\nBoth runs share architecture, data stream, optimiser, and evaluation code; only the loss definition and number of inner steps differ.\n\n\\subsection{Figures}\n\\begin{figure}[H]\n\\centering\n\\includegraphics[width=0.7\\linewidth]{ images/final\\_accuracy\\_comparison.pdf }\n\\caption{Final accuracy comparison between CW-TENT and TENT; higher is better.}\n\\end{figure}\n\n\\begin{figure}[H]\n\\centering\n\\includegraphics[width=0.7\\linewidth]{ images/learning\\_curve.pdf }\n\\caption{Online accuracy over the 10 000-sample stream; higher is better.}\n\\end{figure}\n\n\\begin{figure}[H]\n\\centering\n\\includegraphics[width=0.7\\linewidth]{ images/batch\\_acc\\_distribution.pdf }\n\\caption{Batch-level accuracy distribution for both adapters; higher is better.}\n\\end{figure}\n\n\\begin{figure}[H]\n\\centering\n\\includegraphics[width=0.7\\linewidth]{ images/confusion\\_matrix.pdf }\n\\caption{Confusion matrices of the evaluated models; higher diagonal values are better.}\n\\end{figure}\n\nAdditional artifacts include aggregated metrics and per-run logs (filenames: aggregated\\_metrics.json, metrics.json) and statistical tests (significance\\_tests.json), which are not visual figures but are used to generate the summary plots.",
    "conclusion": "We introduced confidence-weighted entropy minimisation to accelerate BN-only test-time adaptation by collapsing the inner loop to a single gradient step. An empirical study on CIFAR-10-C reveals that, in its naïve form, the method dramatically underperforms the multi-step TENT baseline, achieving 10.11 percent versus 37.41 percent final accuracy. Detailed diagnostics attribute the collapse to unstable Batch-Norm statistics, learning-rate overshoot, and excessive weight saturation. Although CW-TENT delivers a ten-fold reduction in computation, its accuracy deficit currently precludes practical deployment.\n\nOur findings contribute a carefully documented negative result that sharpens understanding of loss shaping in TTA. They stress that objective modifications must be co-designed with normalisation and optimisation mechanisms, echoing lessons from DELTA’s focus on robust statistics \\cite{zhao-2023-delta} and from regularised test-time training in related tasks \\cite{author-year-test}. Future work should implement temperature-scaled weights, adaptive learning rates proportional to the batch-mean weight, hybrid weighted-plus-unweighted updates, and improved normalisers to recover stability while retaining single-step efficiency."
}
